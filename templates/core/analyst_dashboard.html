{% extends 'base.html' %}

{% block css %}
    <link rel="stylesheet" type="text/css" href="{{ STATIC_URL }}theme/global/plugins/select2/select2.css">
    <link rel="stylesheet" href="{{ STATIC_URL }}theme/global/plugins/data-tables/DT_bootstrap.css">

{% endblock %}

{% block extra_css %}
    <link rel ="stylesheet" type="text/css" href="{{ STATIC_URL }}new_theme/global/css/components.min.css">
    <link rel ="stylesheet" type="text/css" href="{{ STATIC_URL }}new_theme/global/css/components-md.min.css">
    <link rel ="stylesheet" type="text/css" href="{{ STATIC_URL }}new_theme/global/css/components-rounded.min.css">

<style>
.comply_badge {
    background-color: #35aa47;
    margin-left: 10px;
    padding-left: 10px;
    padding-right: 10px;
}
</style>

{% endblock %}


{% block js %}
    <script type="text/javascript" src="{{ STATIC_URL }}theme/global/plugins/data-tables/jquery.dataTables.js"></script>
    <script type="text/javascript" src="{{ STATIC_URL }}theme/global/plugins/data-tables/DT_bootstrap.js"></script>
    <script src="{{ STATIC_URL }}new_theme/global/plugins/counterup/jquery.waypoints.min.js" type="text/javascript"></script>
    <script src="{{ STATIC_URL }}new_theme/global/plugins/counterup/jquery.counterup.min.js" type="text/javascript"></script>
    <script type="text/javascript">
        $(document).ready(function () {
            $('#new_table').dataTable({
                 "aaSorting": [[4, "desc"]]
            });
            $('#in_progress_table').dataTable({
                 "aaSorting": [[4, "desc"]]
            });
        });

    </script>

<script type="text/javascript">
    $(document).ready(function () {
        $('.counter').counterUp({
               delay: 10,
                time: 1000
        });

    });

</script>
{% endblock %}

{% block sidebar %}
    {% include 'core/_analyst_sidebar.html' %}
{% endblock %}

{% block content %}
{% load spotlit_extras %}
    <div class="page-content-wrapper">
        <div class="page-content">
            <h3 style="padding-top:10px;" class="page-title">Welcome</h3>
        <div class="page-bar">
            <ul class="page-breadcrumb">
                <li>
                    <i class="fa fa-home"></i>
                    <a href="{% url 'redirect' %}">Home</a>
                </li>
            </ul>
        </div>
        <div class="clearfix">

        </div>
        <div class="row">
            <div class="row widget-row">
                    <div class="col-md-3">
                        <!-- BEGIN WIDGET THUMB -->
                        <a href="{% url 'analyst_new_requests' %}">
                            <div class="widget-thumb widget-bg-color-white text-uppercase margin-bottom-20 bordered" style="margin-left: 15px">
                                <h4 class="widget-thumb-heading">New Requests</h4>
                                <div class="widget-thumb-wrap">
                                    <i class="widget-thumb-icon bg-green icon-envelope-open"></i>
                                    <div class="widget-thumb-body">
                                        <span class="widget-thumb-subtitle">Assign to Analysts<span class="badge counter comply_badge">{{new_count}}</span></span>
                                        <span class="widget-thumb-body-stat counter" id="new_requests">{{unassigned_count}}</span>
                                    </div>
                                </div>
                            </div>
                        </a>

                        <!-- END WIDGET THUMB -->
                    </div>
                    <div class="col-md-3">
                        <!-- BEGIN WIDGET THUMB -->
                        <a href="{% url 'analyst_completed_requests'  %}">
                            <div class="widget-thumb widget-bg-color-white text-uppercase margin-bottom-20 bordered">
                                <h4 class="widget-thumb-heading">Completed Requests</h4>
                                <div class="widget-thumb-wrap">
                                    <i class="widget-thumb-icon bg-red icon-directions"></i>
                                    <div class="widget-thumb-body">
                                        <span class="widget-thumb-subtitle">Submit or Return</span>
                                        <span class="widget-thumb-body-stat counter">{{completed_count}}</span>
                                    </div>
                                </div>
                            </div>
                        </a>
                        <!-- END WIDGET THUMB -->
                    </div>
                    <div class="col-md-3">
                        <!-- BEGIN WIDGET THUMB -->
                        <a href="{% url 'analyst_in_progress_requests'  %}">
                            <div class="widget-thumb widget-bg-color-white text-uppercase margin-bottom-20 bordered">
                                <h4 class="widget-thumb-heading">In Progress</h4>
                                <div class="widget-thumb-wrap">
                                    <i class="widget-thumb-icon bg-purple icon-arrow-down"></i>
                                    <div class="widget-thumb-body">
                                        <span class="widget-thumb-subtitle">In Progress Requests</span>
                                        <span class="widget-thumb-body-stat counter" >{{in_progress_count}}</span>
                                    </div>
                                </div>
                            </div>
                        </a>
                        <!-- END WIDGET THUMB -->
                    </div>
                    <div class="col-md-3">
                        <!-- BEGIN WIDGET THUMB -->
                        <a href="{% url 'analyst_advanced_search' %}">
                            <div class="widget-thumb widget-bg-color-white text-uppercase margin-bottom-20 bordered" style="margin-right: 15px">
                                <h4 class="widget-thumb-heading">All Reports</h4>
                                <div class="widget-thumb-wrap">
                                    <i class="widget-thumb-icon bg-blue icon-bar-chart"></i>
                                    <div class="widget-thumb-body">
                                        <span class="widget-thumb-subtitle">Search and Reports</span>
                                        <span class="widget-thumb-body-stat counter">{{all_count}}</span>
                                    </div>
                                </div>
                            </div>
                        </a>
                        <!-- END WIDGET THUMB -->
                    </div>
                </div>

        </div>
            <div class="row">
                <div class="col-md-6">
                    <div class="portlet box prescient-green">
                        <div class="portlet-title">
                            <div class="caption">
                                New & Returned
                            </div>
                            <div class="tools">
                                <a href="javascript:;" class="collapse">
                                </a>
                            </div>
                        </div>
                        <div class="portlet-body">
                            <div class="table-responsive">
                                <table class="table table-striped table-boardered table-hover dataTable"
                                       id="new_table">
                                    <thead>
                                        <tr>
                                                <th style="width: 10%">ID</th>
                                                <th style="width: 30%">Name</th>
                                                <th style="width: 20%">Company Name</th>
                                                <th style="width: 20%">Request Type</th>
                                                <th style="width: 20%">Date</th>
                                                <th style="width: 20%">Due Date</th>
                                        </tr>
                                    </thead>
                                    {% for status in new_new_returned %}
                                    <tr>
                                        {% if status.content_type|is_custom_request %}
                                        <td>
                                            <a href="{% url 'request_analyst_for_custom' status.object_id %}"
                                                class="btn btn-xs grey btn-editable">
                                                {{status.content_object.display_id}}
                                            </a>
                                        </td>
                                        {% endif %}

                                        {% if status.content_type|is_corporate_request %}
                                        <td>
                                            <a href="{% url 'request_analyst_for_corporate' status.object_id %}"
                                                class="btn btn-xs grey btn-editable">
                                                {{status.content_object.display_id}}
                                            </a>
                                        </td>
                                        {% endif %}

                                        {% if status.content_type|is_individual_request %}
                                        <td>
                                            <a href="{% url 'request_analyst' status.object_id %}"
                                                class="btn btn-xs grey btn-editable">
                                                {{status.content_object.display_id}}
                                            </a>
                                        </td>
                                        {% endif %}

                                        {% if status.content_type|is_custom_request %}
                                            <td>{{status.content_object.name}}</td>
                                        {% endif %}

                                        {% if status.content_type|is_corporate_request %}
                                            <td>{{status.content_object.company_name}}</td>
                                        {% endif %}

                                        {% if status.content_type|is_individual_request %}
                                            <td>{{status.content_object.first_name}} {{status.content_object.last_name}}</td>
                                        {% endif %}
                                        <td>{{status.content_object.created_by.company.name}}</td>

                                        <td>{{status.content_object.request_type}}</td>
                                        <td>{{status.datetime|date:"DATETIME_FORMAT"}}</td>
                                        <td>{{status.content_object.due_date|date:"DATE_FORMAT"}}</td>


                                    </tr>
                                    {% endfor %}


                                </table>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="col-md-6">
                    <div class="portlet box prescient-green">
                        <div class="portlet-title">
                            <div class="caption">
                                In Progress Reports
                            </div>
                            <div class="tools">
                                <a href="javascript:;" class="collapse">
                                </a>
                            </div>
                        </div>
                        <div class="portlet-body">
                            <div class="table-responsive">
                                <table class="table table-striped table-boardered table-hover dataTable"
                                       id="in_progress_table">
                                    <thead>
                                        <tr>
                                                <th style="width: 10%">ID</th>
                                                <th style="width: 30%">Name</th>
                                                <th style="width: 20%">Company Name</th>
                                                <th style="width: 20%">Request Type</th>
                                                <th style="width: 20%">Date</th>
                                                <th style="width: 20%">Due Date</th>
                                        </tr>
                                    </thead>

                                    {% for status in in_progress_statuses %}
                                    <tr>
                                        {% if status.content_type|is_custom_request %}
                                        <td>
                                            <a href="{% url 'request_analyst_for_custom' status.object_id %}"
                                                class="btn btn-xs grey btn-editable">
                                                {{status.content_object.display_id}}
                                            </a>
                                        </td>
                                        {% endif %}

                                        {% if status.content_type|is_corporate_request %}
                                        <td>
                                            <a href="{% url 'request_analyst_for_corporate' status.object_id %}"
                                                class="btn btn-xs grey btn-editable">
                                                {{status.content_object.display_id}}
                                            </a>
                                        </td>
                                        {% endif %}

                                        {% if status.content_type|is_individual_request %}
                                        <td>
                                            <a href="{% url 'request_analyst' status.object_id %}"
                                                class="btn btn-xs grey btn-editable">
                                                {{status.content_object.display_id}}
                                            </a>
                                        </td>
                                        {% endif %}

                                        {% if status.content_type|is_custom_request %}
                                            <td>{{status.content_object.name}}</td>
                                        {% endif %}

                                        {% if status.content_type|is_corporate_request %}
                                            <td>{{status.content_object.company_name}}</td>
                                        {% endif %}

                                        {% if status.content_type|is_individual_request %}
                                            <td>{{status.content_object.first_name}} {{status.content_object.last_name}}</td>
                                        {% endif %}
                                        <td>{{status.content_object.created_by.company.name}}</td>

                                        <td>{{status.content_object.request_type}}</td>
                                        <td>{{status.datetime|date:"DATETIME_FORMAT"}}</td>
                                        <td>{{status.content_object.due_date|date:"DATE_FORMAT"}}</td>
                                    </tr>
                                    {% endfor %}

                                </table>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
{% endblock %}